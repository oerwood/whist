<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overførselsberegner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function opdaterSpillerFelter() {
            let antalSpillere = parseInt(document.getElementById("antalSpillere").value);
            let spillerContainer = document.getElementById("spillereContainer");
            spillerContainer.innerHTML = "";

            for (let i = 1; i <= antalSpillere; i++) {
                let div = document.createElement("div");
                div.className = "spiller-container";

                div.innerHTML = `
                    <label>Navn for spiller ${i}: <input type="text" id="spillerNavn${i}" placeholder="Spiller ${i}"></label><br>
                    <label>Point for spiller ${i}: <input type="number" id="spiller${i}" value="0" min="0"></label>
                `;
                spillerContainer.appendChild(div);
            }
        }

        function beregnOverførsler() {
            let antalSpillere = parseInt(document.getElementById("antalSpillere").value);
            let krPerPoint = parseFloat(document.getElementById("kr_per_point").value) || 2;
            let spillere = { "kr_per_point": krPerPoint };

            for (let i = 1; i <= antalSpillere; i++) {
                let navn = document.getElementById(`spillerNavn${i}`).value.trim() || `Spiller ${i}`;
                let point = parseInt(document.getElementById(`spiller${i}`).value) || 0;
                spillere[navn] = point;
            }

            fetch('/beregn', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(spillere)
            })
            .then(response => response.json())
            .then(data => {
                let resultDiv = document.getElementById("resultat");
                resultDiv.innerHTML = "<h2>Overførsler:</h2>";

                if (data.error) {
                    resultDiv.innerHTML += `<p style="color: red;">${data.error}</p>`;
                } else {
                    data.forEach(item => {
                        resultDiv.innerHTML += `<p>${item.Fra} → ${item.Til}: ${item.Beløb.toFixed(2)} kr.</p>`;
                    });
                }
            });
        }
    </script>
</head>
<body onload="opdaterSpillerFelter()">
    <div class="container">
        <h1>Overførselsberegner</h1>

        <label>Antal spillere (3-8): 
            <input type="number" id="antalSpillere" value="6" min="3" max="8" onchange="opdaterSpillerFelter()">
        </label>
        <br><br>

        <div id="spillereContainer"></div>

        <h2>Beløb pr. point:</h2>
        <label>Kr. pr. point: <input type="number" id="kr_per_point" value="2" step="0.1"></label><br><br>

        <button onclick="beregnOverførsler()">Beregn</button>

        <div id="resultat" class="resultat-container"></div>
    </div>
</body>
</html>
